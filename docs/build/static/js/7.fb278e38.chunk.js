(this["webpackJsonpreact-adminv4"]=this["webpackJsonpreact-adminv4"]||[]).push([[7],{103:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return E}));var n,r,l,i=a(108),o=a(30),c=a(11),s=a(14),u=a(15),d=a(17),p=a(16),b=a(0),m=a.n(b),h=a(4),f=a(10),y=a(47),g=[{value:"",label:"\u9879\u76ee\u5185\u90e8\u7a97\u53e3"},{value:"_self",label:"\u66ff\u6362\u5f53\u524d\u7a97\u53e3"},{value:"_blank",label:"\u6253\u5f00\u65b0\u7a97\u53e3"}],v=Object(f.a)({ajax:!0,modal:{width:700,title:function(e){var t=e.data,a=void 0===t?{}:t,n=a.key;return"1"===a.type?n?"\u7f16\u8f91\u83dc\u5355":"\u6dfb\u52a0\u83dc\u5355":n?"\u7f16\u8f91\u529f\u80fd":"\u6dfb\u52a0\u529f\u80fd"}}})(n=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,iconVisible:!1},e.handleSubmit=function(t){if(!e.state.loading){console.log("Received values of form: ",t);var a=t.key,n=t.parentKey,r=a?e.props.ajax.put:e.props.ajax.post,l=a?"/menus/".concat(a):"/menus",i=e.props.onOk;e.setState({loading:!0}),r(l,Object(c.a)(Object(c.a)({},t),{},{id:a,parentId:n})).then((function(){e.setState({visible:!1}),i&&i()})).finally((function(){return e.setState({loading:!1})}))}},e.handleCancel=function(){var t=e.props.onCancel;t&&t()},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props.data,a=this.state.loading,n=t.type,r=t.icon,l=void 0===r?"bars":r,i=!n||"1"===n,o={width:300,labelWidth:80};return m.a.createElement(h.i,{surplusSpace:!1,loading:a,okText:"\u4fdd\u5b58",onOk:function(){return e.form.submit()},cancelText:"\u91cd\u7f6e",onCancel:function(){return e.form.resetFields()}},m.a.createElement(y.default,{ref:function(t){return e.form=t},onFinish:this.handleSubmit,style:{padding:16},initialValues:Object(c.a)(Object(c.a)({},t),{},{icon:l})},m.a.createElement(h.a,Object.assign({},o,{type:"hidden",name:"key"})),m.a.createElement(h.a,Object.assign({},o,{type:"hidden",name:"parentKey"})),m.a.createElement(h.a,Object.assign({},o,{type:"hidden",name:"type"})),m.a.createElement(h.b,null,m.a.createElement(h.a,Object.assign({},o,{label:"\u540d\u79f0",name:"text",required:!0,autoFocus:!0})),i?m.a.createElement(h.a,Object.assign({},o,{width:180,label:"\u56fe\u6807",name:"icon"}),m.a.createElement(h.g,null)):m.a.createElement(h.a,Object.assign({},o,{width:"auto",label:"\u7f16\u7801",name:"code",required:!0,labelTip:"\u552f\u4e00\u6807\u8bc6\uff0c\u786c\u7f16\u7801\uff0c\u524d\u7aef\u4e00\u822c\u4f1a\u7528\u4e8e\u63a7\u5236\u6309\u94ae\u662f\u5426\u663e\u793a\u3002"})),i?m.a.createElement(h.a,Object.assign({},o,{labelWidth:"auto",width:120,label:"\u6392\u5e8f",type:"number",name:"order",min:0,step:1})):null),m.a.createElement(h.b,null,!(null!==t&&void 0!==t&&t.parentKey)&&m.a.createElement(h.a,Object.assign({},o,{label:"\u57fa\u7840\u8def\u5f84",name:"basePath",labelTip:"\u83dc\u5355\u5bf9\u5e94\u7684\u9875\u9762\u57fa\u7840\u5730\u8d28\u5730\u5740\uff0c\u6240\u6709\u7684\u5b50\u83dc\u5355\u300c\u8def\u5f84\u300d\u300curl\u300d\u4f1a\u62fc\u63a5\u6b64\u300c\u57fa\u7840\u8def\u5f84\u300d"})),m.a.createElement(h.a,Object.assign({},o,{label:"\u8def\u5f84",name:"path",labelTip:"\u83dc\u5355\u5bf9\u5e94\u7684\u9875\u9762\u5730\u5740\uff0c\u6216\u8005\u529f\u80fd\u5bf9\u5e94\u7684\u9875\u9762\u5730\u5740\u3002\u524d\u7aef\u4f1a\u57fa\u4e8e\u7528\u6237\u6240\u62e5\u6709\u7684\u300c\u8def\u5f84\u300d\uff0c\u5bf9\u8def\u7531\u8fdb\u884c\u8fc7\u6ee4\u3002"}))),i?m.a.createElement(h.b,null,m.a.createElement(h.a,Object.assign({},o,{label:"url",name:"url",labelTip:"iframe\u65b9\u5f0f\u63a5\u5165\u7b2c\u4e09\u65b9\u7f51\u7ad9\u7684url\uff0c\u5982\u679c\u5b58\u5728\u300c\u57fa\u7840\u8def\u5f84\u300d\uff0c\u4f1a\u4e0e\u57fa\u7840\u8def\u5f84\u8fdb\u884c\u62fc\u63a5\u3002"})),m.a.createElement(h.a,Object.assign({},o,{type:"select",label:"target",name:"target",options:g,labelTip:"iframe\u65b9\u5f0f\u63a5\u5165\u7684\u7b2c\u4e09\u65b9\u7f51\u7ad9\u6253\u5f00\u65b9\u5f0f\u3002"}))):null))}}]),a}(b.Component))||n,k=a(136),j=a.n(k),O=Object(f.a)({ajax:!0,modal:{width:1e3,title:"\u6279\u91cf\u6dfb\u52a0"}})(r=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,iconVisible:!1},e.handleSubmit=function(t){if(!e.state.loading){var a=t.menus,n=t.parentKey,r=j.a.parse(a);Array.isArray(r)||(r=[r]),r.forEach((function(e){e.parentKey||(e.parentKey=n),e.icon||(e.icon="bars"),e.id=e.key,e.parentId=e.parentKey}));var l=e.props.onOk;e.setState({loading:!0}),e.props.ajax.post("/batchAddMenus",{menus:r}).then((function(){e.setState({visible:!1}),l&&l()})).finally((function(){return e.setState({loading:!1})}))}},e.handleCancel=function(){var t=e.props.onCancel;t&&t()},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props.data,a=this.state.loading,n={labelWidth:0};return m.a.createElement(h.i,{surplusSpace:!1,loading:a,okText:"\u4fdd\u5b58",onOk:function(){return e.form.submit()},cancelText:"\u91cd\u7f6e",onCancel:function(){return e.form.resetFields()}},m.a.createElement(y.default,{ref:function(t){return e.form=t},onFinish:this.handleSubmit,style:{padding:16},initialValues:Object(c.a)({},t)},m.a.createElement(h.a,Object.assign({},n,{type:"hidden",name:"parentKey"})),m.a.createElement(h.a,Object.assign({},n,{type:"textarea",label:"\u540d\u79f0",name:"menus",colon:!1,rows:20,required:!0,autoFocus:!0,rules:[{validator:function(e,t){if(!t)return Promise.resolve();try{return j.a.parse(t),Promise.resolve()}catch(a){return Promise.reject(a.message)}}}],placeholder:"\u6279\u91cf\u6dfb\u52a0\u83dc\u5355\u3001\u529f\u80fd\uff0c\u683c\u5f0f\u5982\u4e0b\uff1a\n[\n    { key: 'antDesign', text: 'Ant Design \u5b98\u7f51', icon: 'ant-design', url: 'https://ant-design.gitee.io', target: '', order: 2000 },\n    { key: 'document', text: '\u6587\u6863', icon: 'book', url: 'http://shubin.wang/docs', target: '_blank', order: 1200 },\n    { key: 'customer-header', text: '\u81ea\u5b9a\u4e49\u5934\u90e8', icon: 'api', path: '/example/customer-header', order: 998 },\n    { key: 'user', text: '\u7528\u6237\u7ba1\u7406', icon: 'user', path: '/users', order: 900 },\n    { key: 'role', text: '\u89d2\u8272\u7ba1\u7406', icon: 'lock', path: '/roles', order: 900 },\n    { key: 'menu', text: '\u83dc\u5355\u7ba1\u7406', icon: 'align-left', path: '/menu', order: 900 },\n    { key: 'gen', text: '\u4ee3\u7801\u751f\u6210', icon: 'code', path: '/gen', order: 900 },\n    { key: 'page404', text: '404\u9875\u9762\u4e0d\u5b58\u5728', icon: 'file-search', path: '/404', order: 700 },\n    { key: 'example', text: '\u793a\u4f8b', icon: 'align-left', order: 600 },\n    { key: 'table-editable', parentKey: 'example', text: '\u53ef\u7f16\u8f91\u8868\u683c', icon: 'align-left', path: '/example/table-editable', order: 600 },\n]\n                        "}))))}}]),a}(b.Component))||r,x=a(48);a(111);var E=Object(f.a)({path:"/menus"})(l=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,menus:[],visible:!1,batchAddVisible:!1,record:{},iconVisible:!1},e.columns=[{title:"\u540d\u79f0",dataIndex:"text",key:"text",width:300,render:function(e,t){var a=t.icon;return a?m.a.createElement("span",null,m.a.createElement(h.f,{type:a})," ",e):e}},{title:"\u57fa\u7840\u8def\u5f84",dataIndex:"basePath",key:"basePath",width:150},{title:"\u8def\u5f84",dataIndex:"path",key:"path"},{title:"url",dataIndex:"url",key:"url",width:100},{title:"target",dataIndex:"target",key:"target",width:60,render:function(e){var t=g.find((function(t){return t.value===e}));return null===t||void 0===t?void 0:t.label}},{title:"\u7c7b\u578b",dataIndex:"type",key:"type",width:60,render:function(e,t){return t.url?m.a.createElement("span",{style:{color:"purple"}},"\u5916\u7ad9"):"1"===e?m.a.createElement("span",{style:{color:"green"}},"\u83dc\u5355"):"2"===e?m.a.createElement("span",{style:{color:"orange"}},"\u529f\u80fd"):m.a.createElement("span",{style:{color:"green"}},"\u83dc\u5355")}},{title:"\u6392\u5e8f",dataIndex:"order",key:"order",width:60},{title:"\u64cd\u4f5c",dataIndex:"operator",key:"operator",width:180,render:function(t,a){var n=a.type,r=void 0===n?"1":n,l=[{label:"\u7f16\u8f91",icon:"form",onClick:function(){return e.setState({data:Object(c.a)(Object(c.a)({},a),{},{type:r}),visible:!0})}},{label:"\u5220\u9664",icon:"delete",color:"red",confirm:{title:"\u60a8\u8bf7\u786e\u5b9a\u8981\u5220\u9664\u6b64\u8282\u70b9\u53ca\u5176\u5b50\u8282\u70b9\u5417\uff1f",onConfirm:function(){return e.handleDeleteNode(a)}}},{label:"\u6dfb\u52a0\u5b50\u83dc\u5355",icon:"folder-add",onClick:function(){return e.setState({data:{parentKey:a.key,type:"1"},visible:!0})}},{label:"\u6dfb\u52a0\u5b50\u529f\u80fd",icon:"file-add",onClick:function(){return e.setState({data:{parentKey:a.key,type:"2"},visible:!0})}},{label:"\u6279\u91cf\u6dfb\u52a0\u5b50\u83dc\u5355",icon:"bars",onClick:function(){return e.setState({data:{parentKey:a.key},batchAddVisible:!0})}}];return m.a.createElement(h.j,{items:l})}}],e.handleAddTopMenu=function(){e.setState({data:{type:"1"},visible:!0})},e.handleDeleteNode=function(t){var a=t.id;e.setState({loading:!0}),e.props.ajax.del("/menus/".concat(a)).then((function(){e.setState({visible:!1}),e.handleSearch()})).finally((function(){return e.setState({loading:!1})}))},e}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.handleSearch()}},{key:"handleSearch",value:function(){var e=this;this.setState({loading:!0}),Object(x.a)().then((function(t){var a=t.map((function(e){return Object(c.a)({key:e.id,parentKey:e.parentId},e)})),n=Object(o.a)(a).sort((function(e,t){var a=e.order||0,n=t.order||0;return a||n?n-a:e.text>t.text?1:-1})),r=h.D.convertToTree(n);e.setState({menus:r})})).finally((function(){return e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.menus,n=t.visible,r=t.batchAddVisible,l=t.loading,o=t.data;return m.a.createElement(h.l,{className:"root-1jnxL"},m.a.createElement(h.q,null,m.a.createElement(i.default,{type:"primary",onClick:this.handleAddTopMenu},"\u6dfb\u52a0\u9876\u7ea7")),m.a.createElement(h.p,{loading:l,columns:this.columns,dataSource:a,pagination:!1}),m.a.createElement(v,{visible:n,data:o,onOk:function(){return e.setState({visible:!1},e.handleSearch)},onCancel:function(){return e.setState({visible:!1})}}),m.a.createElement(O,{visible:r,data:o,onOk:function(){return e.setState({batchAddVisible:!1},e.handleSearch)},onCancel:function(){return e.setState({batchAddVisible:!1})}}))}}]),a}(b.Component))||l},108:function(e,t,a){e.exports=a(5)(59)},111:function(e,t,a){}}]);
//# sourceMappingURL=7.fb278e38.chunk.js.map